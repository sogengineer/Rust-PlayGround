# åˆ¶ç´„ä»˜ããƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•ã®ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ

## ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æµã‚Œ

```
é–‹å§‹: practice4_limited_hops(graph, start, end, max_hops)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åˆæœŸåŒ–                              â”‚
â”‚ - n = graph.len()                   â”‚
â”‚ - distances[n][max_hops+1] = âˆã§åˆæœŸåŒ–â”‚
â”‚ - distances[start][0] = 0           â”‚
â”‚ - heap.push((0, start, 0))          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ while heap ãŒç©ºã§ãªã„               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ (cost, node, hop_count) = heap.pop()â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ hop_count > max_hops?               â”‚
â”œâ”€â”€â”€ Yes â†’ continueï¼ˆæ¬¡ã®ãƒ«ãƒ¼ãƒ—ã¸ï¼‰    â”‚
â””â”€â”€â”€ No â†’ æ¬¡ã¸                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ cost > distances[node][hop_count]?  â”‚
â”œâ”€â”€â”€ Yes â†’ continueï¼ˆæ—¢ã«è‰¯ã„çµŒè·¯ã‚ã‚Šï¼‰ â”‚
â””â”€â”€â”€ No â†’ æ¬¡ã¸                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ node == end?                        â”‚
â”œâ”€â”€â”€ Yes â†’ return Some(cost) ğŸ¯       â”‚
â””â”€â”€â”€ No â†’ æ¬¡ã¸                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ hop_count < max_hops?               â”‚
â”œâ”€â”€â”€ No â†’ continueï¼ˆãƒ›ãƒƒãƒ—æ•°é™ç•Œï¼‰     â”‚
â””â”€â”€â”€ Yes â†’ éš£æ¥ãƒãƒ¼ãƒ‰æ¢ç´¢              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ for (next_node, edge_cost) in éš£æ¥  â”‚
â”‚   - new_cost = cost + edge_cost     â”‚
â”‚   - next_hop = hop_count + 1        â”‚
â”‚                                      â”‚
â”‚   if new_cost < distances[next][hop]â”‚
â”‚     - distancesæ›´æ–°                  â”‚
â”‚     - heap.push(new_cost,next,hop)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
  ãƒ«ãƒ¼ãƒ—ç¶™ç¶š
    â†“
å…¨ã¦å‡¦ç†å¾Œ: return Noneï¼ˆåˆ°é”ä¸å¯ï¼‰
```

## å…·ä½“ä¾‹ï¼šæ±äº¬â†’ç¥æˆ¸ï¼ˆmax_hops=2ï¼‰

### ã‚°ãƒ©ãƒ•æ§‹é€ 
```
æ±äº¬(0) --30-- æ¨ªæµœ(1)
  |              |
 50             20
  |              |
å¤§é˜ª(2) --40-- äº¬éƒ½(3)
  |              |
 60             15
  |              |
åå¤å±‹(4)------ç¥æˆ¸(5)
       25
```

### å®Ÿè¡Œãƒˆãƒ¬ãƒ¼ã‚¹

| ã‚¹ãƒ†ãƒƒãƒ— | heap.pop() | å‡¦ç†å†…å®¹ | heapè¿½åŠ  |
|---------|------------|----------|----------|
| åˆæœŸ | - | distances[0][0]=0 | (0,æ±äº¬,0) |
| 1 | (0,æ±äº¬,0) | æ±äº¬!=ç¥æˆ¸, hop=0<2 | (30,æ¨ªæµœ,1), (50,å¤§é˜ª,1) |
| 2 | (30,æ¨ªæµœ,1) | æ¨ªæµœ!=ç¥æˆ¸, hop=1<2 | (50,äº¬éƒ½,2) |
| 3 | (50,å¤§é˜ª,1) | å¤§é˜ª!=ç¥æˆ¸, hop=1<2 | (110,åå¤å±‹,2) |
| 4 | (50,äº¬éƒ½,2) | äº¬éƒ½!=ç¥æˆ¸, hop=2=2 | æ¢ç´¢ä¸å¯ï¼ˆé™ç•Œï¼‰ |
| 5 | (110,åå¤å±‹,2) | åå¤å±‹!=ç¥æˆ¸, hop=2=2 | æ¢ç´¢ä¸å¯ï¼ˆé™ç•Œï¼‰ |
| çµ‚äº† | - | heapç©º | **Noneè¿”ã™** |

### distancesé…åˆ—ã®çŠ¶æ…‹

```
distances[ãƒãƒ¼ãƒ‰][ãƒ›ãƒƒãƒ—æ•°] = ã‚³ã‚¹ãƒˆ

        [0hop] [1hop] [2hop]
æ±äº¬[0]    0      âˆ      âˆ
æ¨ªæµœ[1]    âˆ     30      âˆ
å¤§é˜ª[2]    âˆ     50      âˆ
äº¬éƒ½[3]    âˆ      âˆ     50
åå¤å±‹[4]  âˆ      âˆ    110
ç¥æˆ¸[5]    âˆ      âˆ      âˆ  â† åˆ°é”ä¸å¯
```

## é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

### 1. ãªãœ2æ¬¡å…ƒé…åˆ—ãªã®ã‹
- **åŒã˜ãƒãƒ¼ãƒ‰ã§ã‚‚ã€ãƒ›ãƒƒãƒ—æ•°ãŒé•ãˆã°åˆ¥ã®çŠ¶æ…‹**
- ä¾‹ï¼šäº¬éƒ½ã¸ã®çµŒè·¯
  - 1ãƒ›ãƒƒãƒ—ï¼šä¸å¯èƒ½ï¼ˆç›´æ¥è¡Œã‘ãªã„ï¼‰
  - 2ãƒ›ãƒƒãƒ—ï¼š50ï¼ˆæ±äº¬â†’æ¨ªæµœâ†’äº¬éƒ½ï¼‰
  - 3ãƒ›ãƒƒãƒ—ï¼š90ï¼ˆæ±äº¬â†’å¤§é˜ªâ†’äº¬éƒ½ï¼‰â€»åˆ¥çµŒè·¯

### 2. ãƒ›ãƒƒãƒ—æ•°ã®æ•°ãˆæ–¹
```
æ±äº¬ â†’ æ¨ªæµœ â†’ äº¬éƒ½ â†’ ç¥æˆ¸
 0     1      2      3   â† ãƒ›ãƒƒãƒ—æ•°
       â†‘      â†‘      â†‘
     1ç§»å‹•  2ç§»å‹•  3ç§»å‹•
```

### 3. æ—©æœŸçµ‚äº†ã®æ¡ä»¶
- `node == end`ã§å³åº§ã«`return Some(cost)`
- ã“ã‚ŒãŒæœ€çŸ­è·é›¢ï¼ˆãƒ’ãƒ¼ãƒ—ã¯æœ€å°ã‚³ã‚¹ãƒˆé †ï¼‰

### 4. åˆ¶ç´„ãƒã‚§ãƒƒã‚¯ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°
- `hop_count > max_hops`ï¼šå‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—
- `hop_count < max_hops`ï¼šã¾ã æ¢ç´¢å¯èƒ½
- `hop_count == max_hops`ï¼šã“ã‚Œä»¥ä¸Šé€²ã‚ãªã„

## ã¾ã¨ã‚

åˆ¶ç´„ä»˜ããƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•ã¯ã€é€šå¸¸ã®ãƒ€ã‚¤ã‚¯ã‚¹ãƒˆãƒ©æ³•ã«ã€Œãƒ›ãƒƒãƒ—æ•°ã€ã¨ã„ã†çŠ¶æ…‹ã‚’è¿½åŠ ã—ãŸã‚‚ã®ã€‚2æ¬¡å…ƒé…åˆ—ã§`[ãƒãƒ¼ãƒ‰][ãƒ›ãƒƒãƒ—æ•°]`ã®çµ„ã¿åˆã‚ã›ã”ã¨ã«æœ€å°ã‚³ã‚¹ãƒˆã‚’ç®¡ç†ã™ã‚‹ã“ã¨ã§ã€ãƒ›ãƒƒãƒ—æ•°åˆ¶é™ä¸‹ã§ã®æœ€çŸ­çµŒè·¯ã‚’æ±‚ã‚ã‚‰ã‚Œã‚‹ã€‚